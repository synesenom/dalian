// https://www.npmjs.com/package/@dalian/tooltip v0.0.1 Copyright 2019 Enys Mones
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("d3-ease"),require("d3-selection"),require("@dalian/core")):"function"==typeof define&&define.amd?define(["d3-ease","d3-selection","@dalian/core"],e):((t=t||self).dalian=t.dalian||{},t.dalian.Tooltip=e(t.d3,t.d3,t.dalian.core))}(this,function(t,e,o){"use strict";return(i,n)=>{(i=i||{})._tooltip={containerId:"dalian-tooltip-container",containerElem:void 0,id:`${i._widget.id}-tooltip`,elem:void 0,on:!1};return i._widget.update=o.extend(i._widget.update,()=>{i._widget.container.style("pointer-events",i._tooltip.on?"all":null).on("mousemove",()=>i._tooltip.on&&i._tooltip.show())}),i._tooltip.createContent=(()=>{console.warn("createTooltip(mouse) is not implemented")}),i._tooltip.show=(()=>{let o=e.mouse(i._widget.container.node()),n=e.event.pageX,l=e.event.pageY,d=i._widget.container.node().getBoundingClientRect(),a={left:window.pageXOffset||document.documentElement.scrollLeft,top:window.pageYOffset||document.documentElement.scrollTop};if(n<d.left+i._widget.margins.left-a.left||n>d.right-i._widget.margins.right+a.left||l<d.top+i._widget.margins.top-a.top||l>d.bottom-i._widget.margins.bottom+a.top)return void e.select("#"+i._tooltip.id).transition().duration(200).style("opacity",0).on("end",function(){e.select(this).style("display","none")});i._tooltip.containerElem=(()=>{if(e.select("#"+i._tooltip.containerId).empty())return e.select("body").append("div").attr("id",i.tooltip.containerId)})(),i._tooltip.elem=((t,e)=>void 0===i._tooltip.elem||i._tooltip.elem.empty()?i._tooltip.containerElem.append("div").attr("id",i._tooltip.id).style("position","absolute").style("background-color","rgba(255, 255, 255, 0.9)").style("border-r","2px").style("box-shadow","0 0 3px grey").style("font-family",'"Courier", monospace').style("font-size","0.7em").style("color","black").style("pointer-events","none").style("left",(t.left+t.right)/2+e.left+"px").style("top",(t.top+t.bottom)/2+e.top+"px"):i._tooltip.elem)(d,a);let p=i._tooltip.createContent([o[0]-i._widget.margins.left,o[1]-i._widget.margins.top]);if(void 0===p){if(void 0!==i._tooltip.elem)return void i._tooltip.elem.transition().duration(200).style("opacity",0).on("end",function(){e.select(this).style("display","none")})}else i._tooltip.elem.html(p);let r=i._tooltip.elem.node().getBoundingClientRect(),s=r.width,m=r.height,c=n+20,g=l+20;c+s>d.right-i._widget.margins.right+a.left-5&&(c-=s+a.left+40),g+m>d.bottom-i._widget.margins.bottom+a.top-5&&(g=d.bottom-i._widget.margins.bottom+a.top-10-m),i._tooltip.elem.style("display","block").transition().duration(0).style("opacity",1).transition(),i._tooltip.elem.transition().duration(200).ease(t.easeLinear).style("left",c+"px").style("top",g+"px")}),(n=n||{}).tooltip=(t=>(i._tooltip.on=t,n)),{self:i,api:n}}});
