// https://www.npmjs.com/package/@dalian/tooltip v0.0.1 Copyright 2019 Enys Mones
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("d3-ease"),require("d3-selection")):"function"==typeof define&&define.amd?define(["d3-ease","d3-selection"],e):(t=t||self).Tooltip=e(t.d3,t.d3)}(this,function(t,e){"use strict";return(o,i)=>{let n=o||{};n.tooltip={containerId:"dalian-tooltip-container",containerElem:void 0,id:`${n.widget.id}-tooltip`,elem:void 0,on:!1};n.tooltip.createContent=(()=>{console.warn("createTooltip(mouse) is not implemented")}),n.tooltip.show=(()=>{let o=e.mouse(n.widget.dom.container.node()),i=e.event.pageX,l=e.event.pageY,d=n.widget.dom.container.node().getBoundingClientRect(),p={left:window.pageXOffset||document.documentElement.scrollLeft,top:window.pageYOffset||document.documentElement.scrollTop};if(i<d.left+n.widget.margins.left-p.left||i>d.right-n.widget.margins.right+p.left||l<d.top+n.widget.margins.top-p.top||l>d.bottom-n.widget.margins.bottom+p.top)return void e.select("#"+n.tooltip.id).transition().duration(200).style("opacity",0).on("end",function(){e.select(this).style("display","none")});n.tooltip.containerElem=(()=>{if(e.select("#"+n.tooltip.containerId).empty())return e.select("body").append("div").attr("id",n.tooltip.containerId)})(),n.tooltip.elem=((t,e)=>void 0===n.tooltip.elem||n.tooltip.elem.empty()?n.tooltip.containerElem.append("div").attr("id",n.tooltip.id).style("position","absolute").style("background-color","rgba(255, 255, 255, 0.9)").style("border-r","2px").style("box-shadow","0 0 3px grey").style("font-family",'"Courier", monospace').style("font-size","0.7em").style("color","black").style("pointer-events","none").style("left",(t.left+t.right)/2+e.left+"px").style("top",(t.top+t.bottom)/2+e.top+"px"):n.tooltip.elem)(d,p);let s=n.tooltip.createContent([o[0]-n.widget.margins.left,o[1]-n.widget.margins.top]);if(void 0===s){if(void 0!==n.tooltip.elem)return void n.tooltip.elem.transition().duration(200).style("opacity",0).on("end",function(){e.select(this).style("display","none")})}else n.tooltip.elem.html(s);let r=n.tooltip.elem.node().getBoundingClientRect(),a=r.width,m=r.height,c=i+20,f=l+20;c+a>d.right-n.widget.margins.right+p.left-5&&(c-=a+p.left+40),f+m>d.bottom-n.widget.margins.bottom+p.top-5&&(f=d.bottom-n.widget.margins.bottom+p.top-10-m),n.tooltip.elem.style("display","block").transition().duration(0).style("opacity",1).transition(),n.tooltip.elem.transition().duration(200).ease(t.easeLinear).style("left",c+"px").style("top",f+"px")});let l=i||{};return l.tooltip=(t=>(n.tooltip.on=t,l)),{self:n,api:l}}});
