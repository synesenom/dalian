// https://www.npmjs.com/package/@dalian/component-tooltip v0.0.2 Copyright 2019 Enys Mones
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("d3-ease"),require("d3-selection"),require("@dalian/core")):"function"==typeof define&&define.amd?define(["d3-ease","d3-selection","@dalian/core"],e):((t=t||self).dalian=t.dalian||{},t.dalian.components=t.dalian.components||{},t.dalian.components.Tooltip=e(t.d3,t.d3,t.dalian.core))}(this,function(t,e,o){"use strict";return(i,n)=>{(i=i||{})._tooltip={container:{id:"dalian-tooltip-container"},id:`${i._widget.id}-tooltip`,on:!1};const l=()=>{void 0!==i._tooltip.elem&&i._tooltip.elem.transition().duration(200).style("opacity",0).on("end",function(){e.select(this).style("display","none")})};return i._widget.update=o.extend(i._widget.update,()=>{i._widget.container.style("pointer-events",i._tooltip.on?"all":null).on("mousemove",()=>{i._tooltip.on&&i._tooltip.show()}).on("mouseout",l)}),i._tooltip.createContent=(()=>{console.warn("createTooltip(mouse) is not implemented")}),i._tooltip.show=(()=>{let o=e.event.pageX,n=e.event.pageY,d=i._widget.container.node().getBoundingClientRect(),p={left:window.pageXOffset||document.documentElement.scrollLeft,top:window.pageYOffset||document.documentElement.scrollTop};if(o<d.left+i._widget.margins.left-p.left||o>d.right-i._widget.margins.right+p.left||n<d.top+i._widget.margins.top-p.top||n>d.bottom-i._widget.margins.bottom+p.top)return void l();i._tooltip.container.elem=(()=>{if(e.select("#"+i._tooltip.container.id).empty())return e.select("body").append("div").attr("id",i._tooltip.container.id)})(),i._tooltip.elem=((t,e)=>void 0===i._tooltip.elem||i._tooltip.elem.empty()?i._tooltip.container.elem.append("div").attr("id",i._tooltip.id).style("position","absolute").style("background-color","rgba(255, 255, 255, 0.9)").style("border-radius","2px").style("box-shadow","0 0 3px grey").style("font-size","0.7em").style("color","black").style("pointer-events","none").style("left",(t.left+t.right)/2+e.left+"px").style("top",(t.top+t.bottom)/2+e.top+"px"):i._tooltip.elem)(d,p);let a=e.mouse(i._widget.container.node()),s=i._tooltip.createContent([a[0]-i._widget.margins.left,a[1]-i._widget.margins.top]);if(void 0===s){if(void 0!==i._tooltip.elem)return void l()}else i._tooltip.elem.html(s);let r=i._tooltip.elem.node().getBoundingClientRect(),m=r.width,c=r.height,g=o+20,_=n+20;g+m>d.right-i._widget.margins.right+p.left-5&&(g-=m+p.left+40),_+c>d.bottom-i._widget.margins.bottom+p.top-5&&(_=d.bottom-i._widget.margins.bottom+p.top-10-c),i._tooltip.elem.style("display","block").transition().duration(0).style("opacity",1).transition(),i._tooltip.elem.transition().duration(200).ease(t.easeLinear).style("left",g+"px").style("top",_+"px")}),(n=n||{}).tooltip=(t=>(i._tooltip.on=t,n)),{self:i,api:n}}});
