// https://www.npmjs.com/package/dalian v0.0.2 Copyright 2020 Enys Mones
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("d3"),require("d3-interpolate-path")):"function"==typeof define&&define.amd?define(["exports","d3","d3-interpolate-path"],e):e((t=t||self).dalian={},t.d3,t.d3)}(this,function(t,e,a){"use strict";var i=t=>(""+t).replace(/ /g,"__"),r=(t,e,a=!1)=>{let i=t;return(...t)=>{a?(e(...t),i(...t)):(i(...t),e(...t))}},n=(t,...e)=>{let{self:a,api:i}=t;return e.reduce((t,e)=>{let r=e(t.self,t.api);return{self:Object.assign(a,r.self),api:Object.assign(i,r.api)}},{self:a,api:i})},o=["#333333","#0072b2","#56b4e9","#009e73","#f0e442","#e69f00","#d55e00","#cc79a7"];const l={protan:{cpu:.735,cpv:.265,am:1.273463,ayi:-.073894},deutan:{cpu:1.14,cpv:-.14,am:.968437,ayi:.003331},tritan:{cpu:.171,cpv:-.003,am:.062921,ayi:.292119}};function s(t){return{r:3.063218*t.x-1.393325*t.y-.475802*t.z,g:-.969243*t.x+1.875966*t.y+.041555*t.z,b:.067871*t.x-.228834*t.y+1.069251*t.z}}function c(t,e){let a=1.75,i=a+1;return d3.rgb((a*e.r+t.r)/i,(a*e.g+t.g)/i,(a*e.b+t.b)/i)}function d(t){let e=Math.round(.299*t.r+.587*t.g+.114*t.b);return d3.rgb(e,e,e)}function p(t,e){let a={r:Math.pow(t.r/255,2.2),g:Math.pow(t.g/255,2.2),b:Math.pow(t.b/255,2.2)};var i;const r=(a={x:.430574*(i=a).r+.34155*i.g+.178325*i.b,y:.222015*i.r+.706655*i.g+.07133*i.b,z:.020183*i.r+.129553*i.g+.93918*i.b}).x+a.y+a.z;a.u=0,a.v=0,0!==r&&(a.u=a.x/r,a.v=a.y/r);let n,o=.312713*a.y/.329016,c=.358271*a.y/.329016,d={y:0};n=a.u<l[e].cpu?(l[e].cpv-a.v)/(l[e].cpu-a.u):(a.v-l[e].cpv)/(a.u-l[e].cpu);let p=a.v-a.u*n;d.u=(l[e].ayi-p)/(n-l[e].am),d.v=n*d.u+p;let u={x:d.u*a.y/d.v,y:a.y,z:(1-(d.u+d.v))*a.y/d.v};d.x=o-u.x,d.z=c-u.z,d=s(d),u=s(u);let g={r:d.r?((u.r<0?0:1)-u.r)/d.r:0,g:d.g?((u.g<0?0:1)-u.g)/d.g:0,b:d.b?((u.b<0?0:1)-u.b)/d.b:0},m=Math.max(g.r>1||g.r<0?0:g.r,g.g>1||g.g<0?0:g.g,g.b>1||g.b<0?0:g.b);u.r=u.r+m*d.r,u.g=u.g+m*d.g,u.b=u.b+m*d.b;const h=t=>255*(t<=0?0:t>=1?1:Math.pow(t,1/2.2));return d3.rgb(h(u.r),h(u.g),h(u.b))}const u={protanopia:t=>p(t,"protan"),protanomaly:t=>c(t,p(t,"protan")),deuteranopia:t=>p(t,"deutan"),deuteranomaly:t=>c(t,p(t,"deutan")),tritanopia:t=>p(t,"tritan"),tritanomaly:t=>c(t,p(t,"tritan")),achromatopsia:t=>d(t),achromatomaly:t=>c(t,d(t))};const g=t=>"string"==typeof t?()=>t:Array.isArray(t)?(()=>{let e=[];return a=>{let i=e.indexOf(a);return t[i>-1?i:e.push(a)-1]}})():"object"==typeof t?e=>t[e]:void 0;var m=(t,e)=>{let a={on:t=>t,palette:o,converter:t=>t,getMapping:()=>g(((t,e)=>{if("string"==typeof t)return e(t)+"";if(Array.isArray(t))return t.map(e);{let a={};for(let i in t)a[i]=e(t[i]);return a}})(a.palette,a.converter)),mapping:g(o)};return{self:t=Object.assign(t||{},{_color:{mapGroup:t=>a.mapping(a.on(t))}}),api:e=Object.assign(e||{},{color:{palette:(t,i)=>(a.palette=t||o,a.on=i||(t=>t),a.mapping=a.getMapping(),e),deficiency:t=>(a.converter=(t=>void 0===u[t]?t=>t:e=>u[t](d3.rgb(e)))(t),a.mapping=a.getMapping(),e)}})}},h=(t,e)=>{for(let a in e)e.hasOwnProperty(a)&&t.style(a,e[a]);return t},y=(t,a)=>{let i={id:`${t._widget.id}-description`,getDescription:()=>void 0===i.elem||i.elem.empty()?h(e.select("body").append("div").attr("id",i.id),{position:"absolute",left:e.event.pageX+20+"px",top:e.event.pageY-20+"px",width:"auto","max-width":"500px",padding:"10px",background:"#fff","box-shadow":"0 0 3px #000","border-radius":"3px",color:"#000","font-size":".8em","font-family":"inherit","line-height":"1.35em","pointer-events":"none"}):i.elem,removeDescription:()=>{void 0===i.elem||i.elem.empty()||(i.elem.remove(),delete i.elem)}};return a=Object.assign(a||{},{description:r=>(void 0===r?t._widget.container.on("contextmenu.description",null):t._widget.container.on("contextmenu.description",()=>{e.event.preventDefault(),i.elem=i.getDescription().html(r)}).on("mouseleave.description",()=>{i.removeDescription()}),a)}),{self:t,api:a}},x=(t,e)=>{let a={size:12,color:"black"};return(t=Object.assign(t||{},{_font:{size:a.size+"px",color:a.color}}))._widget.update=r(t._widget.update,()=>{t._widget.container.style("font-size",t._font.size).style("color",t._font.color)},!0),e=Object.assign(e||{},{font:{size:i=>(t._font.size=(i||a.size)+"px",e),color:i=>(t._font.color=i||a.color,e)}}),{self:t,api:e}},_=(t,e)=>{let a={callbacks:{}};return{self:t=Object.assign(t||{},{_mouse:{over:(...t)=>{"function"==typeof a.callbacks.over&&a.callbacks.over(...t)},leave:(...t)=>{"function"==typeof a.callbacks.leave&&a.callbacks.leave(...t)},click:(...t)=>{"function"==typeof a.callbacks.click&&a.callbacks.click(...t)},isEnabled:t=>"function"==typeof a.callbacks[t],hasAny:()=>Object.values(a.callbacks).reduce((t,e)=>t||"function"==typeof e,!1)}}),api:e=Object.assign(e||{},{mouse:{over:t=>(a.callbacks.over=t,e),leave:t=>(a.callbacks.leave=t,e),click:t=>(a.callbacks.click=t,e)}})}},f=(t,e)=>{let a={id:`${t._widget.id}-placeholder`};return t._widget.update=r(t._widget.update,e=>{void 0!==a.elem&&a.elem.style("font-size","inherit").transition().duration(e).style("width",t._widget.size.width).style("height",t._widget.size.height).style("color","inherit")}),e=Object.assign(e||{},{placeholder:(i,r=400)=>(void 0===i?(t._widget.content.style("display","block").transition().duration(r).style("opacity",1),t._widget.disable(!1),void 0===a.elem||a.elem.empty()||(a.elem.transition().duration(r).style("opacity",0).remove(),delete a.elem)):(t._widget.content.transition().duration(r).style("opacity",0).on("end",()=>{t._widget.content.style("display","none")}),t._widget.disable(!0),(void 0===a.elem||a.elem.empty())&&(a.elem=t._widget.container.append("div").attr("id",a.id).attr("class","dalian-placeholder"),h(a.elem,{display:"table",position:"absolute",width:t._widget.size.width,height:t._widget.size.height,left:0,top:0,color:"inherit","font-family":"inherit","font-size":"inherit","pointer-events":"none"}),h(a.elem.append("span"),{display:"table-cell","vertical-align":"middle","line-height":"normal","text-align":"center",color:"inherit","font-family":"inherit","font-size":"inherit",opacity:0}).html(i).transition().duration(r).style("opacity",1))),e)}),{self:t,api:e}},v=(t,a,o,l)=>{let{self:s,api:c}=n(((t,a,i,r)=>{let n={parent:e.select(i),pos:{x:{attr:"left",ignore:"right",value:"0px"},y:{attr:"top",ignore:"bottom",value:"0px"}}},o={};o._widget={id:`dalian-widget-${t}-${a}`,container:void 0,size:{width:"300px",height:"200px",innerWidth:"300px",innerHeight:"200px"},margins:{left:0,right:0,top:0,bottom:0},transition:!1,disabled:!1,update:t=>{o._widget.container.transition().duration(t).style(n.pos.x.ignore,null).style(n.pos.x.attr,n.pos.x.value).style(n.pos.y.ignore,null).style(n.pos.y.attr,n.pos.y.value).style("width",o._widget.size.width).style("height",o._widget.size.height).on("end",()=>o._widget.container.style("display","block"))},disable:t=>{o._widget.disabled=t}};try{o._widget.container=n.parent.append("div").attr("id",o._widget.id).attr("class",`dalian-widget dalian-widget-${t}`),h(o._widget.container,{display:"none",position:"absolute",width:o._widget.size.width,height:o._widget.size.height,left:n.pos.x+"px",top:n.pos.y+"px","font-family":"inherit","font-size":"inherit","font-color":"inherit"}),o._widget.content=o._widget.container.append(r).attr("id",`${o._widget.id}-container`).attr("class","dalian-widget-container"),h(o._widget.content,{position:"absolute",width:"100%",height:"100%",left:0,top:0,"font-family":"inherit","font-size":"inherit","font-color":"inherit","pointer-events":"none"})}catch(t){throw Error("MissingDOMException: DOM is not present.")}let l={x:(t=0)=>(n.pos.x.attr=t>=0?"left":"right",n.pos.x.ignore=t>=0?"right":"left",n.pos.x.value=Math.abs(t)+"px",l),y:(t=0)=>(n.pos.y.attr=t>=0?"top":"bottom",n.pos.y.ignore=t>=0?"bottom":"top",n.pos.y.value=Math.abs(t)+"px",l),width:(t=300)=>(o._widget.size.width=t+"px",o._widget.size.innerWidth=t-o._widget.margins.left-o._widget.margins.right+"px",l),height:(t=200)=>(o._widget.size.height=t+"px",o._widget.size.innerHeight=t-o._widget.margins.top-o._widget.margins.bottom+"px",l),margins:t=>{switch(typeof t){case"undefined":default:o._widget.margins={left:0,right:0,top:0,bottom:0};break;case"number":o._widget.margins={left:t,right:t,top:t,bottom:t};break;case"object":o._widget.margins=Object.assign(o._widget.margins,t)}return o._widget.size.innerWidth=parseInt(o._widget.size.width)-o._widget.margins.left-o._widget.margins.right+"px",o._widget.size.innerHeight=parseInt(o._widget.size.height)-o._widget.margins.top-o._widget.margins.bottom+"px",l},render:t=>(o._widget.update(t),l)};return{self:o,api:l}})(t,a,o,l),m,y,f,x,_),d=(()=>{const t=`${a}-dalian-plots-clipper`;return{clipId:t,clip:s._widget.content.append("defs").append("clipPath").attr("id",t).append("rect").attr("x",0).attr("y",0).attr("width",s._widget.size.innerWidth).attr("height",s._widget.size.innerHeight),update:t=>{d.clip.transition().duration(t).attr("width",s._widget.size.innerWidth).attr("height",s._widget.size.innerHeight),s._chart.plots.transition().duration(t).attr("width",s._widget.size.innerWidth+"px").attr("height",s._widget.size.innerHeight+"px").attr("transform","translate("+s._widget.margins.left+","+s._widget.margins.top+")")}}})();return(s=Object.assign(s||{},{_chart:{plots:s._widget.content.append("g").attr("class","dalian-plots-container"),plotSelectors:[],clipId:d.clipId,transformData:t=>t,plotGroups:(t,e)=>{let a=s._chart.plots.selectAll(".plot-group").data(s._chart.data,t=>t.name).join(e=>{let a=e.append("g").attr("class",t=>`plot-group ${i(t.name)}`).attr("clip-path",`url(#${d.clipId})`).style("color",t=>s._color.mapGroup(t.name)).style("shape-rendering","geometricPrecision");return t.enter?t.enter(a):a},t=>t,a=>{let i=a.transition().duration(e);(i=t.exit?t.exit(i):i).remove()}).on("mouseover.mouse",s._mouse.over).on("mouseleave.mouse",s._mouse.leave).on("click.mouse",s._mouse.click).each(()=>{s._chart.plots.style("pointer-events","none"),s._widget.transition=!0});a=(a=t.updateBefore?t.updateBefore(a):a).transition().duration(e).style("color",t=>s._color.mapGroup(t.name)),(a=t.update?t.update(a):a).on("end",()=>{s._chart.plots.style("pointer-events",s._tooltip&&s._tooltip.isOn()||s._mouse.hasAny()?"all":"none"),s._widget.transition=!1})}}}))._widget.update=r(s._widget.update,d.update),c=Object.assign(c,{data:t=>(s._chart.data=s._chart.transformData(t),c)}),{self:s,api:c}},b=(t,e,a,i)=>{let r=e.append("g").attr("class",`dalian-axis-container ${t}`).style("font-family","inherit").style("font-size","inherit"),n=r.append("g").attr("class",`${t} axis`).style("font-family","inherit").style("font-size","inherit");n.selectAll("path").style("fill","none").style("stroke-width","1px").style("shape-rendering","crispEdges").style("stroke","currentColor");let o={format:t=>t,scale:i,container:r,ticks:!0,axisLine:!0},l={label:"",fn:a().ticks(5),axis:n,axisLabel:r.append("text").attr("class",`axis-label ${t}`).attr("stroke-width",0).attr("fill","currentColor").style("font-size","1em").text(""),scale:t=>{o.scale=t},adjustLabel:t=>{Object.entries(t).forEach(t=>{l.axisLabel.attr(...t)})},update:(t,e,a)=>{o.container.transition().duration(t).attr("transform","translate("+a.left+","+a.top+")").style("width",e.innerWidth).style("height",e.innerHeight),l.fn.scale(o.scale.scale).tickFormat(o.format).tickSize(o.ticks?6:0).tickPadding(o.ticks?3:9),l.axis.transition().duration(t).call(l.fn).selectAll("path").style("opacity",o.axisLine?1:0),l.axisLabel.text(l.label)},hideAxisLine:t=>o.axisLine=!t,hideTicks:t=>o.ticks=!t,tickFormat:(t=(t=>t))=>o.format=t,setLabel:t=>l.label=t};return l},w=t=>(()=>(a,i)=>{let n=b("x",a._widget.content,e.axisBottom,t);n.adjustLabel({"text-anchor":"end",dy:"2.5em"});let o=t=>{n.axis.transition().duration(t).attr("transform","translate(0,"+parseFloat(a._widget.size.innerHeight)+")"),n.axisLabel.transition().duration(t).attr("x",a._widget.size.innerWidth).attr("y",parseFloat(a._widget.size.innerHeight)+"px")};return n.update=r(n.update,o),a._widget.update=r(a._widget.update,t=>n.update(t,a._widget.size,a._widget.margins)),a=Object.assign(a||{},{_bottomAxis:{axis:n.fn,update:n.update,scale:n.scale,label:()=>n.label}}),i=Object.assign(i||{},{bottomAxis:{label:(t="")=>(n.setLabel(t),i),tickFormat:t=>(n.tickFormat(t),i),hideTicks:t=>(n.hideTicks(t),i),hideAxisLine:t=>(n.hideAxisLine(t),i)}}),{self:a,api:i}})(),k=t=>(()=>(a,r)=>{let n={selectors:t,highlightSelection:(t,r,n)=>{if(a._widget.transition)return;let o=a._highlight.container.selectAll(t);if(o.transition(),"string"==typeof r)o.transition().duration(n).style("opacity",function(){return e.select(this).classed(i(r))?1:.1});else if(Array.isArray(r)){let t=r.map(i);o.transition().duration(n).style("opacity",function(){let a=e.select(this);return t.reduce((t,e)=>t||a.classed(e),!1)?1:.1})}else o.transition().duration(n||0).style("opacity",1)}};return a=Object.assign(a||{},{_highlight:{container:void 0,selectors:void 0}}),r=Object.assign(r||{},{highlight:(t,e)=>{if(void 0===a._highlight.container)throw Error("Highlight.container is not specified");return n.selectors.forEach(a=>n.highlightSelection(a,t,e)),r}}),{self:a,api:r}})(),z=t=>(()=>(a,i)=>{let n=b("y",a._widget.content,e.axisLeft,t);n.adjustLabel({"text-anchor":"begin",x:"5px",y:"-5px"});let o=t=>{n.update(t,a._widget.size,a._widget.margins)};return(a=Object.assign(a||{},{_leftAxis:{axis:n.fn,update:n.update,scale:n.scale,label:()=>n.label}}))._widget.update=r(a._widget.update,o,!0),i=Object.assign(i||{},{leftAxis:{label:t=>(n.setLabel(t),i),tickFormat:t=>(n.tickFormat(t),i),hideTicks:t=>(n.hideTicks(t),i),hideAxisLine:t=>(n.hideAxisLine(t),i)}}),{self:a,api:i}})(),M=t=>(e,a)=>{let i={value:t};return{self:e=Object.assign(e||{},{_opacity:{value:()=>i.value}}),api:a=Object.assign(a||{},{opacity:e=>(i.value=e||t,a)})}},j=(t,e)=>{for(let a in e)e.hasOwnProperty(a)&&t.attr(a,e[a]);return t},O=(t,e)=>{let a={markers:new Map};return{self:t=Object.assign(t||{},{_plotMarker:{add(e,r,n,o,l){a.markers.set(n,a.markers.get(n)||t._chart.plots.append("circle")),j(a.markers.get(n),{class:`plot-marker ${i(o)}`,cx:e,cy:r,r:l||4}),h(a.markers.get(n),{stroke:"white",fill:t._color.mapGroup(o),"pointer-events":"none"})},remove(t){void 0===t?a.markers.forEach((t,e)=>{t.remove(),a.markers.delete(e)}):a.markers.has(t)&&(a.markers.get(t).remove(),a.markers.delete(t))}}}),api:e}},C=(t,a)=>{let i={container:{id:"dalian-tooltip-container"},id:`${t._widget.id}-tooltip`,on:!1,getContainer:()=>{let a=e.select("#"+i.container.id);return a.empty()&&(a=e.select("body").append("div").attr("id",i.container.id)),a.style("color",t._font.color),a},getTooltip:(t,e)=>void 0===i.elem||i.elem.empty()?h(i.container.elem.append("div").attr("id",i.id),{position:"absolute","background-color":"rgba(255, 255, 255, 0.95)","border-radius":"2px","box-shadow":"0 0 2px #aaa",color:"currentColor","pointer-events":"none","font-size":"0.85em","font-family":"inherit",width:"auto","line-height":"1",left:(t.left+t.right)/2+e.left+"px",top:(t.top+t.bottom)/2+e.top+"px"}):i.elem,hideTooltip:()=>{void 0!==i.elem&&i.elem.style("opacity",0)},showTooltip:()=>{let a=e.event.pageX,r=e.event.pageY,n=t._widget.container.node().getBoundingClientRect(),o={left:window.pageXOffset||document.documentElement.scrollLeft,top:window.pageYOffset||document.documentElement.scrollTop};if(a<n.left+t._widget.margins.left-o.left||a>n.right-t._widget.margins.right+o.left||r<n.top+t._widget.margins.top-o.top||r>n.bottom-t._widget.margins.bottom+o.top)return t._tooltip.builder(),void i.hideTooltip();i.container.elem=i.getContainer(),i.elem=i.getTooltip(n,o);let l=e.mouse(t._widget.container.node()),s=t._tooltip.builder(t._tooltip.content([l[0]-t._widget.margins.left,l[1]-t._widget.margins.top]));if(void 0===s){if(void 0!==i.elem)return void i.hideTooltip()}else i.elem.html(s);let c=i.elem.node().getBoundingClientRect(),d=c.width,p=c.height,u=a+20,g=r+20;u+d>n.right-t._widget.margins.right+o.left-10&&(u-=d+o.left+40),g+p>n.bottom-t._widget.margins.bottom+o.top-10&&(g=n.bottom-t._widget.margins.bottom+o.top-10-p),i.elem.style("left",u+"px").style("top",g+"px").style("opacity",1)}};return t._widget.update=r(t._widget.update,()=>{t._widget.container.style("pointer-events",i.on?"all":null).on("mousemove.tooltip",()=>i.on&&!t._widget.disabled&&i.showTooltip()).on("mouseout.tooltip",i.hideTooltip)}),t=Object.assign(t||{},{_tooltip:{isOn:()=>i.on,content:()=>console.warn("content(mouse) is not implemented"),builder:()=>console.warn("builder(mouse) is not implemented"),titleFormat:t=>t,rowFormat:t=>t,xFormat:t=>t,yFormat:t=>t,ignore:[]}}),a.tooltip={on:(t=!1)=>(i.on=t,a),ignore:e=>(t._tooltip.ignore=e||[],a),titleFormat:(e=(t=>t))=>(t._tooltip.titleFormat=e,a),rowFormat:(e=(t=>t))=>(t._tooltip.rowFormat=e,a),xFormat:(e=(t=>t))=>(t._tooltip.xFormat=e,a),yFormat:(e=(t=>t))=>(t._tooltip.yFormat=e,a)},{self:t,api:a}},F=(t,a)=>{let i=C(t,a);return t._tooltip=Object.assign(i.self._tooltip,{builder:a=>{if(void 0===a)return void t._tooltip.content();let i=h(e.select(document.createElement("div")),{display:"table",padding:"10px"});return h(i.append("div"),{display:"table-row",position:"relative"}).text(t._tooltip.xFormat(a.title)),a.content.data.sort((t,e)=>t.name.localeCompare(e.name)).forEach((e,a)=>{let r=h(i.append("div"),{display:"table-row",position:"relative"});h(r.append("div"),{display:"table-cell",position:"relative",width:"9px",height:"9px",top:"1px",float:"left","margin-top":(0===a?6:3)+"px","margin-right":"10px",background:e.background}),h(r.append("div"),{display:"table-cell",position:"relative","max-width":"120px","margin-top":(0===a?6:3)+"px",float:"left"}).html(t._tooltip.yFormat(e.value))}),i.node().outerHTML}}),{self:t,api:a}},$=(t="linear",a="linear")=>{let i={kind:t,type:a,scale:(()=>{switch(t){default:case"linear":return e.scaleLinear();case"band":return e.scaleBand().padding(.1);case"point":return e.scalePoint().padding(.5)}})()},r={scale:i.scale,range:(t,e)=>(i.scale.range([t,e]),r),domain:t=>{switch(i.kind){default:case"linear":i.scale.domain([Math.min(...t),Math.max(...t)]);break;case"band":case"point":i.scale.domain(t)}return r},kind:t=>{if(void 0===t)return i.kind;switch(t){default:case"linear":i.scale=e.scaleLinear();break;case"band":i.scale=e.scaleBand().padding(.1);break;case"point":i.scale=e.scalePoint().padding(.5)}}};return r},A=(t,a)=>{let i={on:!1};return{self:t=Object.assign(t||{},{_smoothing:{curve:()=>i.on?e.curveMonotoneX:e.curveLinear}}),api:a=Object.assign(a||{},{smoothing:t=>(i.on=t||!1,a)})}},L=()=>{let t={min:null,max:null,scaleMax:0,scaleMin:0};return{min:e=>t.min=e,max:e=>t.max=e,expandMin:e=>t.scaleMin=Math.abs(e||0),expandMax:e=>t.scaleMax=Math.abs(e||0),range:e=>{let a=void 0!==t.min&&null!==t.min?t.min:Math.min(...e),i=void 0!==t.max&&null!==t.max?t.max:Math.max(...e),r=i-a;return[a-=t.scaleMin>0?t.scaleMin*r:0,i+=t.scaleMax>0?t.scaleMax*r:0]},contains:e=>(void 0===t.min||null===t.min||e>=t.min)&&(void 0===t.max||null===t.max||e<=t.max)}},S=(t,e)=>{let a=L();return{self:t=Object.assign(t||{},{_yRange:{range:a.range,contains:a.contains}}),api:e=Object.assign(e||{},{yRange:{min:t=>(a.min(t),e),expandMin:t=>(a.expandMin(t),e),max:t=>(a.max(t),e),expandMax:t=>(a.expandMax(t),e)}})}};const T=document.createElement("canvas").getContext("2d");function E(t,e){return T.font=e.size+" "+e.family,T.measureText(t).width}function P(t){let e=t/255;return e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4)}function H(t){let a=e.color(t);return.2126*P(a.r)+.7152*P(a.g)+.0722*P(a.b)}function G(t){return H(t)>.179?"#000":"#fff"}var I=(t,a)=>{let i=C(t,a);return t._tooltip=Object.assign(i.self._tooltip,{builder:a=>{if(void 0===a)return void t._tooltip.content();let i=h(e.select(document.createElement("div")),{"border-radius":"2px",padding:"10px","font-family":"inherit","border-left":a.stripe?"solid 4px "+a.stripe:null});return h(i.append("div"),{position:"relative",width:"calc(100% - 10px)","line-height":"11px",margin:"2px","margin-bottom":"10px"}).text(t._tooltip.titleFormat(a.title)),a.content.data.forEach(e=>{let a=h(i.append("div"),{position:"relative",height:"10px",margin:"2px","padding-right":"10px","line-height":"11px"});h(a.append("div"),{position:"relative",float:"left","margin-right":"10px"}).text(e.name+":"),h(a.append("span"),{position:"relative",float:"left"}).html(t._tooltip.rowFormat(e.value))}),i.node().outerHTML}}),{self:t,api:a}},D=t=>(e,a)=>{let i={defaults:{opacity:.3,lineStyle:"4 8"},type:t,on:!1,grid:void 0,opacity:void 0,lineStyle:void 0,update:t=>{if(i.on){void 0===i.grid&&(i.grid=e._chart.plots.insert("g",":first-child").attr("class","grid").style("opacity",0).style("stroke","currentColor").style("stroke-width","1px"));const a="x"===i.type?e._bottomAxis.axis:e._leftAxis.axis,r="x"===i.type?parseFloat(e._widget.size.innerHeight):-parseFloat(e._widget.size.innerWidth);i.grid.transition().duration(t).call(a.tickSizeInner(r).tickFormat("")).style("stroke-opacity",i.opacity||i.defaults.opacity).style("stroke-dasharray",i.lineStyle||i.defaults.lineStyle).style("opacity",1),i.grid.select("path").remove()}else void 0!==i.grid&&(i.grid.transition().duration(t).style("opacity",0).remove(),i.grid=void 0)}};e._widget.update=r(e._widget.update,i.update);let n={type:t=>{i.type=t,i.grid&&(i.grid.remove(),i.grid=void 0)}};const o={on:t=>(i.on=t,a),opacity:t=>(i.opacity=t,a),lineStyle:t=>{switch(t){case"solid":i.lineStyle="1 0";break;case"dashed":default:i.lineStyle="4 8";break;case"dotted":i.lineStyle="2 5"}return a}};return a=Object.assign(a||{},"x"===t?{xGrid:o}:{yGrid:o}),{baseSelf:n,self:e,api:a}},W=(t,e)=>{let a=D("y")(t,e);return{self:t=Object.assign(t||{},{_yGrid:a.baseSelf}),api:a.api}},B=(t,e)=>{let a={policy:void 0,getStrokeDashArray:t=>{switch(t){case"solid":default:return null;case"dashed":return"4 8";case"dotted":return"2 5"}}};return{self:t=Object.assign(t||{},{_lineStyles:{strokeDashArray:t=>void 0===a.policy?null:"string"==typeof a.policy?a.getStrokeDashArray(a.policy):a.getStrokeDashArray(a.policy[t]),style:t=>void 0===a.policy?"solid":"string"==typeof a.policy?a.policy:a.policy[t],background:(t,e)=>{switch(t){case"solid":default:return e;case"dashed":return`repeating-linear-gradient(-45deg, transparent, transparent 2px, ${e} 2px, ${e} 4px`;case"dotted":return`radial-gradient(${e} 30%, transparent 30%) 0.5px 0.5px/4px 4px, radial-gradient(${e} 30%, transparent 30%) 2.5px 2.5px/4px 4px transparent`}}}}),api:e=Object.assign(e||{},{lineStyle:t=>(a.policy=t,e)})}},R=(t,e)=>{let a={mapping:()=>"2px"};return{self:t=Object.assign(t||{},{_lineWidth:{mapping:t=>a.mapping(t)}}),api:e=Object.assign(e||{},{lineWidth:t=>(a.mapping=void 0===t?()=>"2px":"number"==typeof t?()=>t+"px":e=>(t[e]||2)+"px",e)})}},X=D("x"),Y=(t,e)=>{let a=L();return{self:t=Object.assign(t||{},{_xRange:{range:a.range,contains:a.contains}}),api:e=Object.assign(e||{},{xRange:{min:t=>(a.min(t),e),expandMin:t=>(a.expandMin(t),e),max:t=>(a.max(t),e),expandMax:t=>(a.expandMax(t),e)}})}};t.AreaChart=((t,o="body")=>{let l={x:$("linear"),y:$("linear")},{self:s,api:c}=n(v("area-chart",t,o,"svg"),z(l.y),w(l.x),O,M(.4),A,F,k([".plot-group",".plot-marker"]),S),d={scales:l,update:t=>{const r=s._chart.data.map(t=>t.values).flat(),n=r.map(t=>t.y),o=e.extent(n),l=.01*(o[1]-o[0]);o[1]+=l,d.scales.x.range(0,parseInt(s._widget.size.innerWidth)).domain(r.map(t=>t.x)),d.scales.y.range(parseInt(s._widget.size.innerHeight),0).domain(s._yRange.range(o));const c=e.area().x(t=>d.scales.x.scale(t.x)).y0(()=>d.scales.y.scale(0)).y1(t=>d.scales.y.scale(t.y)).curve(s._smoothing.curve()),p=e.line().x(t=>d.scales.x.scale(t.x)).y(t=>d.scales.y.scale(t.y)).curve(s._smoothing.curve());s._chart.plotGroups({enter:t=>(t.style("opacity",0),t.append("path").attr("class",t=>`area ${i(t.name)}`).attr("d",t=>c(t.values)).attr("stroke","none").attr("fill","currentColor"),t.append("path").attr("class",t=>`line ${i(t.name)}`).attr("d",t=>p(t.values)).attr("fill","none").attr("stroke","currentColor"),t),update:t=>(t.select(".area").attrTween("d",function(t){let i=e.select(this).attr("d"),r=c(t.values);return a.interpolatePath(i,r,null)}).style("fill-opacity",s._opacity.value()),t.select(".line").attrTween("d",function(t){let i=e.select(this).attr("d"),r=p(t.values);return a.interpolatePath(i,r,null)}),t.style("opacity",1),t),exit:t=>t.style("opacity",0)},t)}};return s._highlight.container=s._chart.plots,s._tooltip.content=(t=>{if(void 0===t)return void s._plotMarker.remove();let a=e.bisector(t=>d.scales.x.scale(t.x)).left,i=t?s._chart.data.map(e=>a(e.values,t[0])):void 0;if(void 0===i)return void s._plotMarker.remove();let r=d.scales.x.scale.invert(t[0]),n=s._chart.data.filter(t=>-1===s._tooltip.ignore.indexOf(t.name)).map((t,e)=>{let a=i[e],n=t.values,o=n[a-1]?n[a-1]:n[a],l=n[a]?n[a]:n[a-1],c=r-o.x>l.x-r?l:o;return r=c.x,s._plotMarker.add(d.scales.x.scale(r),d.scales.y.scale(c.y),t.name,t.name),{name:t.name,background:s._color.mapGroup(t.name),value:c.y}});return{title:r,content:{type:"plots",data:n}}}),s._chart.transformData=(t=>t.map(t=>({name:t.name,values:t.values.sort((t,e)=>t.x-e.x).map(t=>({x:t.x,y:t.y}))}))),s._widget.update=r(s._widget.update,d.update,!0),c}),t.BarChart=((t,a="body")=>{let o={x:$("band"),y:$("linear")},{self:l,api:s}=n(v("bar-chart",t,a,"svg"),z(o.y),w(o.x),I,k([".plot-group"]),W),c={current:void 0,scales:{x:o.x,y:o.y},measureX:(t,e,a)=>{const i=E(l._barChart.valueFormat(t.value),a),r=Math.max((e-parseFloat(a.size))/2,5),n=c.scales.x.scale(t.value),o=n>2*r+i;return{inside:o,x:o?n-r:n+r+i,y:c.scales.y.scale(t.name)+e/2,color:o?G(l._color.mapGroup(t.name)):a.color}},measureY:(t,e,a)=>{const i=parseFloat(a.size),r=Math.max((e-E(l._barChart.valueFormat(t.value),a))/2,5),n=c.scales.y.scale(t.value),o=parseFloat(l._widget.size.innerHeight)-n>2*r+i;return{inside:o,x:c.scales.x.scale(t.name)+e/2,y:o?n+r:n-r-i,color:o?G(l._color.mapGroup(t.name)):a.color}},update:t=>{const a=window.getComputedStyle(l._widget.container.node()),r={size:a.fontSize,family:a.fontFamily,color:a.color},n=l._chart.data.map(t=>t.name),o=1.01*e.max(l._chart.data.map(t=>t.value))||1;c.scales.x.range(0,parseInt(l._widget.size.innerWidth)).domain(l._barChart.horizontal?[0,o]:n),c.scales.y.range(parseInt(l._widget.size.innerHeight),0).domain(l._barChart.horizontal?n:[0,o]),l._chart.plotGroups({enter:t=>{const e=l._barChart.horizontal?c.scales.y.scale.bandwidth():c.scales.x.scale.bandwidth(),a=t.append("rect").attr("class",t=>`bar ${i(t.name)}`).attr("fill","currentColor").on("mouseover.barChart",t=>{c.current=t}).on("mouseleave.barChart",()=>{c.current=void 0});l._barChart.horizontal?a.attr("x",c.scales.x.scale(0)).attr("width",0).attr("y",t=>c.scales.y.scale(t.name)).attr("height",e):a.attr("x",t=>c.scales.x.scale(t.name)).attr("width",e).attr("y",c.scales.y.scale(0)).attr("height",0);const n=l._barChart.horizontal?c.measureX:c.measureY;return t.append("text").style("display","none").attr("class",t=>`bar-value ${i(t.name)}`).attr("stroke","none").style("pointer-events","none").text(t=>l._barChart.valueFormat(t.value)).each(function(t){return this._current=0,Object.assign(t,{_measures:n(t,e,r)})}).attr("fill",t=>t._measures.color).attr("x",t=>l._barChart.horizontal?c.scales.x.scale(0):t._measures.x).attr("y",t=>l._barChart.horizontal?t._measures.y:c.scales.y.scale(0)),t},update:t=>{const a=l._barChart.horizontal?c.scales.y.scale.bandwidth():c.scales.x.scale.bandwidth(),i=t.select(".bar");l._barChart.horizontal?i.attr("x",c.scales.x.scale(0)).attr("width",t=>c.scales.x.scale(t.value)).attr("y",t=>c.scales.y.scale(t.name)).attr("height",a):i.attr("x",t=>c.scales.x.scale(t.name)).attr("width",a).attr("y",t=>c.scales.y.scale(t.value)).attr("height",t=>parseInt(l._widget.size.innerHeight)-c.scales.y.scale(t.value));const n=l._barChart.horizontal?c.measureX:c.measureY;return t.select(".bar-value").attr("text-anchor",l._barChart.horizontal?"end":"middle").attr("dominant-baseline",l._barChart.horizontal?"central":"hanging").attr("font-size",l._font.size).attr("fill",l._font.color).textTween(function(t){let a=this._current;this._current=t.value;let i=e.interpolateNumber(a,t.value);return t=>l._barChart.valueFormat(i(t))}).each(t=>Object.assign(t,{_measures:n(t,a,r)})).attr("fill",t=>t._measures.color).attr("x",t=>t._measures.x).attr("y",t=>t._measures.y).style("display",l._barChart.values?null:"none"),t},exit:t=>t.style("opacity",0)},t)}};return(l=Object.assign(l,{_barChart:{horizontal:!1,values:!1,valueFormat:t=>t.toFixed(1)}}))._highlight.container=l._chart.plots,l._tooltip.content=(()=>{if(void 0!==c.current)return{title:c.current.name,stripe:l._color.mapGroup(c.current.name),content:{type:"plots",data:[{name:"value",value:c.current.value}]}}}),l._widget.update=r(l._widget.update,c.update,!0),s=Object.assign(s,{horizontal:t=>(l._barChart.horizontal=t,c.scales.x=t?o.y:o.x,c.scales.y=t?o.x:o.y,l._bottomAxis.scale(c.scales.x),l._leftAxis.scale(c.scales.y),l._yGrid.type(t?"x":"y"),s),values:t=>(l._barChart.values=t,s),valueFormat:t=>(l._barChart.valueFormat=t||(t=>t.toFixed(1)),s)})}),t.LineChart=((t,o="body")=>{let l={x:$("linear"),y:$("linear")},{self:s,api:c}=n(v("line-chart",t,o,"svg"),z(l.y),w(l.x),k([".plot-group",".plot-marker",".trend-marker"]),B,R,(t=>(()=>(e,a)=>{let i={container:void 0,pins:new Map,getContainer:()=>(void 0===i.container&&(i.container=e._chart.plots.append("g").attr("class","pin-container").attr("clip-path",`url(#${e._chart.clipId})`)),i.container)};return e._widget.update=r(e._widget.update,t=>{i.pins.forEach(e=>e.update(t))}),a.pin={add:(r,n,o={},l)=>{if(i.pins.has(r))return;let s=t.x.scale,c=t.y.scale;const d=o.color||e._font.color,p=(1-(o.height||1))*c.range()[0],u=o.text||"",g=i.getContainer().append("g").attr("class","pin").style("color",d).style("opacity",0),m=g.append("g").attr("class","pin-label").style("opacity",0).style("pointer-events","none"),h=j(m.append("text"),{class:"pin-label-text",y:p-(o.size||6)-10,"text-anchor":"start",stroke:"none",fill:H(d)>.179?"#000":"#fff"}).text(u),y=1.05*h.node().getComputedTextLength();h.attr("x",Math.min(s(n),s.range()[1]-y)).attr("textLength",y);let x=h.node().getBBox();const _=j(m.append("rect"),{class:"pin-label-box",x:x.x-5,y:x.y-5,width:x.width+10,height:x.height+10,rx:2,stroke:"none",fill:""===u?"none":d});m.node().insertBefore(_.node(),h.node());const f=()=>{m.transition().duration(300).style("opacity",1),i.pins.forEach(t=>{t.g.transition().duration(300).style("opacity",t.g===g?1:.1)})},v=()=>{m.transition().duration(300).style("opacity",0),i.pins.forEach(t=>{t.g.transition().duration(300).style("opacity",1)})},b=(()=>{let t=!1;return()=>{t?(m.transition().duration(300).style("opacity",0),i.pins.forEach(t=>{t.g.transition().duration(300).style("opacity",1)}),t=!1):(m.transition().duration(300).style("opacity",1),i.pins.forEach(t=>{t.g.transition().duration(300).style("opacity",t.g===g?1:.1)}),t=!0)}})(),w=j(g.append("line"),{class:"pin-needle",x1:s(n)+1,y1:c.range()[0],x2:s(n)+1,y2:p,stroke:"currentColor","stroke-width":"2px"}).style("pointer-events","all").on("click.pin",b).on("mouseover.pin",f).on("mouseleave.pin",v),k=j(g.append("circle"),{class:"pin-head",cx:s(n)+1,cy:p,r:(o.size||6)+"px",stroke:"white","stroke-width":"1px",fill:"currentColor"}).style("pointer-events","all").on("mouseover.pin",f).on("mouseleave.pin",v);g.transition().duration(l).style("opacity",1);const z={g:g,remove:t=>{g.transition().duration(t).style("opacity",0).on("end",()=>{g.remove()})},update:t=>{w.transition().duration(t).attr("x1",s(n)+1).attr("y1",c.range()[0]).attr("x2",s(n)+1).attr("y2",p),k.transition().duration(t).attr("cx",s(n)+1).attr("cy",p),h.attr("x",Math.min(s(n),s.range()[1]-y)).attr("y",p-(o.size||6)-10),x=h.node().getBBox(),_.attr("x",x.x-5).attr("y",x.y-5).attr("width",x.width+10).attr("height",x.height+10)}};return i.pins.set(r,z),a},remove:(t,e)=>{void 0===t&&(i.pins.forEach(t=>t.remove()),i.pins.clear()),i.pins.has(t)&&(i.pins.get(t).remove(e),i.pins.delete(t))}},{self:e,api:a}})())(l),O,F,A,(t=>(()=>(a,n)=>{let o={container:void 0,trends:new Map,getContainer:()=>(void 0===o.container&&(o.container=a._chart.plots.append("g").attr("class","trend-container").attr("clip-path",`url(#${a._chart.clipId})`)),o.container),adjustTrend:(t,i,r)=>{let n=a._chart.data.find(e=>e.name===t);if(void 0===n)return;let o=e.bisector(t=>t.x).left,l=o(n.values,i),s=o(n.values,r);if(null===l||null===s)return;let c=n.values[l].x,d=n.values[l].y,p=n.values[s].x,u=n.values[s].y;return{start:{x:c,y:d},end:{x:p,y:u},plateau:d<u?u:d}}};return a._widget.update=r(a._widget.update,t=>{o.trends.forEach(e=>e.update(t))}),n.trend={add:(e,r,l,s,c,d=400)=>{if(o.trends.has(e))return n;let p=t.x.scale,u=t.y.scale,g=o.adjustTrend(r,l,s);const m=o.getContainer().append("g").attr("class","trend trend-"+i(r)).style("color",a._color.mapGroup(r)).style("opacity",0),h=j(m.append("path"),{fill:"none",stroke:"currentColor","stroke-dasharray":"3 3","stroke-width":1,d:`M${p(g.start.x)},${u(g.start.y)}V${u(g.plateau)}H${p(g.end.x)}V${u(g.end.y)}`}),y=j(m.append("circle"),{cx:p(g.start.x),cy:u(g.start.y),r:4,stroke:"none",fill:"currentColor"}),x=j(m.append("circle"),{cx:p(g.end.x),cy:u(g.end.y),r:4,stroke:"none",fill:"currentColor"}),_=j(m.append("text"),{x:p(g.start.x),y:u(g.plateau),dy:-5,"text-anchor":"start",fill:a._font.color}).style("font-family","inherit").style("font-size",a._font.size).text(c);m.transition().duration(d).style("opacity",1);const f={g:m,remove:t=>{m.transition().duration(t).style("opacity",0).on("end",()=>{m.remove()})},update:t=>{m.transition().duration(t).style("color",a._color.mapGroup(r));const e=o.adjustTrend(r,l,s);h.transition().duration(t).attr("d",`M${p(e.start.x)},${u(e.start.y)}V${u(e.plateau)}H${p(e.end.x)}V${u(e.end.y)}`),y.transition().duration(t).attr("cx",p(e.start.x)).attr("cy",u(e.start.y)),x.transition().duration(t).attr("cx",p(e.end.x)).attr("cy",u(e.end.y)),_.attr("font-size",a._font.size).attr("fill",a._font.color).transition().duration(t).attr("x",p(e.start.x)).attr("y",u(e.plateau))}};return o.trends.set(e,f),n},remove:(t,e)=>{void 0===t&&(o.trends.forEach(t=>t.remove()),o.trends.clear()),o.trends.has(t)&&(o.trends.get(t).remove(e),o.trends.delete(t))}},{self:a,api:n}})())(l),X,Y,W,S),d={scales:l,update:t=>{const r=s._chart.data.map(t=>t.values).flat().filter(t=>null!==t.y),n=r.map(t=>t.y-t.lo).concat(r.map(t=>t.y+t.hi)),o=e.extent(n),l=.01*(o[1]-o[0]);o[1]+=l,o[0]-=l,d.scales.x.range(0,parseInt(s._widget.size.innerWidth)).domain(s._xRange.range(r.map(t=>t.x))),d.scales.y.range(parseInt(s._widget.size.innerHeight),0).domain(s._yRange.range(o));const c=e.line().defined(t=>null!==t.y).x(t=>d.scales.x.scale(t.x)).y(t=>d.scales.y.scale(t.y)).curve(s._smoothing.curve()),p=e.area().defined(t=>null!==t.y).x(t=>d.scales.x.scale(t.x)).y0(t=>d.scales.y.scale(t.y-t.lo)).y1(t=>d.scales.y.scale(t.y+t.hi)).curve(s._smoothing.curve());s._chart.plotGroups({enter:t=>(t.style("opacity",0),t.append("path").attr("class",t=>`error-band ${i(t.name)}`).attr("d",t=>p(t.values)).attr("stroke","none").attr("fill","currentColor").style("fill-opacity",.2),t.append("path").attr("class",t=>`line ${i(t.name)}`).attr("d",t=>c(t.values)).attr("stroke","currentColor").attr("stroke-width",t=>s._lineWidth.mapping(t.name)).attr("fill","none").attr("stroke-linejoin","round").attr("stroke-linecap","round"),t),update:t=>(t.select(".error-band").attrTween("d",function(t){let i=e.select(this).attr("d"),r=p(t.values);return a.interpolatePath(i,r,null)}),t.select(".line").attrTween("d",function(t){let i=e.select(this).attr("d"),r=c(t.values);return a.interpolatePath(i,r,null)}).style("stroke-dasharray",t=>s._lineStyles.strokeDashArray(t.name)),t.style("opacity",1),t),exit:t=>t.style("opacity",0)},t)}};return s._highlight.container=s._chart.plots,s._tooltip.content=(t=>{if(void 0===t)return void s._plotMarker.remove();let a=e.bisector(t=>d.scales.x.scale(t.x)).left,i=t?s._chart.data.map(e=>a(e.values,t[0])):void 0;if(void 0===i)return void s._plotMarker.remove();let r=d.scales.x.scale.invert(t[0]),n=s._chart.data.filter(t=>-1===s._tooltip.ignore.indexOf(t.name)).map((t,e)=>{let a=i[e],n=t.values,o=n[a-1]?n[a-1]:n[a],l=n[a]?n[a]:n[a-1],c=r-o.x>l.x-r?l:o;return r=c.x,null!==c.y&&s._yRange.contains(c.y)?s._plotMarker.add(d.scales.x.scale(r),d.scales.y.scale(c.y),t.name,t.name):s._plotMarker.remove(t.name),{name:t.name,background:s._lineStyles.background(s._lineStyles.style(t.name),s._color.mapGroup(t.name)),value:c.y}});return{title:r,content:{type:"plots",data:n}}}),s._chart.transformData=(t=>t.map(t=>({name:t.name,values:t.values.sort((t,e)=>t.x-e.x).map(t=>({x:t.x,y:t.y,lo:t.lo||0,hi:t.hi||0}))}))),s._widget.update=r(s._widget.update,d.update,!0),c}),t.ScatterPlot=((t,a="body")=>{let o={x:$("linear"),y:$("linear")},{self:l,api:s}=n(v("scatter-plot",t,a,"svg"),w(o.x),I,k([".plot-group"]),z(o.y),M(.5),O,Y,S),c={diagram:void 0,scales:o,computeDiagram:t=>{const a=t.map(t=>t.values.map(e=>({name:t.name,x:e.x,y:e.y}))).flat();return e.voronoi().x(t=>c.scales.x.scale(t.x)).y(t=>c.scales.y.scale(t.y)).extent([[0,0],[parseInt(l._widget.size.innerWidth),parseInt(l._widget.size.innerHeight)]])(a)},update:t=>{const a=l._chart.data.map(t=>t.values).flat(),r=e.extent(a.map(t=>t.x));c.scales.x.range(0,parseInt(l._widget.size.innerWidth)).domain(l._xRange.range([r[0]-l._scatterPlot.size,r[1]+l._scatterPlot.size]));const n=e.extent(a.map(t=>t.y));c.scales.y.range(parseInt(l._widget.size.innerHeight),0).domain(l._yRange.range([n[0]-l._scatterPlot.size,n[1]+l._scatterPlot.size])),l._chart.plotGroups({enter:t=>(t.style("opacity",0).attr("stroke","none").attr("fill","currentColor"),t.selectAll("circle").data(t=>t.values).enter().append("circle").attr("class",t=>`dot ${i(t.name)}`).attr("cx",t=>c.scales.x.scale(t.x)).attr("cy",t=>c.scales.y.scale(t.y)).attr("r",l._scatterPlot.size),t),updateBefore:e=>(e.style("opacity",1),e.selectAll("circle").data(t=>t.values).join(t=>t.append("circle").attr("class",t=>`dot ${i(t.name)}`).attr("cx",t=>c.scales.x.scale(t.x)).attr("cy",t=>c.scales.y.scale(t.y)).attr("r",l._scatterPlot.size).style("opacity",0),t=>t,e=>e.transition().duration(t).style("opacity",0).remove()).transition().duration(t).attr("cx",t=>c.scales.x.scale(t.x)).attr("cy",t=>c.scales.y.scale(t.y)).attr("r",l._scatterPlot.size).style("opacity",l._opacity.value()),e),exit:t=>t.style("opacity",0)}),c.diagram=c.computeDiagram(l._chart.data)}};return(l=Object.assign(l,{_scatterPlot:{size:4}}))._highlight.container=l._chart.plots,l._tooltip.content=(t=>{if(void 0===t)return void l._plotMarker.remove();const e=c.diagram.find(t[0],t[1],20);if(e)return l._plotMarker.add(c.scales.x.scale(e.data.x),c.scales.y.scale(e.data.y),"marker",e.data.name,Math.max(5,1.5*l._scatterPlot.size)),{title:e.data.name,stripe:l._color.mapGroup(e.data.name),content:{type:"plots",data:[{name:l._bottomAxis.label(),value:e.data.x},{name:l._leftAxis.label(),value:e.data.y}]}};l._plotMarker.remove()}),l._widget.update=r(l._widget.update,c.update,!0),s=Object.assign(s,{size:t=>(l._scatterPlot.size=t||4,s)})}),Object.defineProperty(t,"__esModule",{value:!0})});
